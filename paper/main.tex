\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}

\input{scidefs}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{Local Wave Field Synthesis by Temporal Bandlimitation*
\thanks{This work was supported by the János Bolyai Research Scholarship of the Hungarian Academy of Sciences, the ÚNKP-22-5-BME-318 New National Excellence Program of the Ministry for Innovation and Technology from the source of the National Research, Development and Innovation Fund
and by the OTKA PD-143129 and OTKA K-143436 grants.
}
}

\author{\IEEEauthorblockN{Gergely Firtha}
\IEEEauthorblockA{\textit{Dept. of Networked Systems and Services} \\
\textit{Budapest University of Technologies and Economics}\\
H-1111 Budapest, Hungary \\
firtha@hit.bme.hu}
\and
\IEEEauthorblockN{Nara Hahn}
\IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
\textit{name of organization (of Aff.)}\\
City, Country \\
email address or ORCID}
\and
\IEEEauthorblockN{Frank Schultz}
\IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
\textit{name of organization (of Aff.)}\\
City, Country \\
email address or ORCID}
\and
\IEEEauthorblockN{Péter Fiala}
\IEEEauthorblockA{\textit{Dept. of Networked Systems and Services} \\
\textit{Budapest University of Technologies and Economics}\\
H-1111 Budapest, Hungary \\
fiala@hit.bme.hu}
}

\maketitle

\begin{abstract}
    Wave Field Synthesis (WFS) aims at the reproduction of a desired target wavefront by driving an ideally continuous loudspeaker distribution with properly chosen secondary source driving signals.
    In practical applications, using a discrete set of loudspeakers degrades the accuracy of reproduction heavily due to the violation of the theoretical requirements.
    As a result, spatial aliasing wavefronts emerge from the individual loudspeaker elements in addition to the intended virtual wavefront, perceived as strong colouration above the so-called spatial aliasing frequency.
    Local Wave Field Synthesis (LWFS) approaches improve the reproduction accuracy over a limited listening area by allowing stronger artefacts outside the control region.
    The present contribution discusses a novel LWFS approach, relying on the transformation of spatially defined antialiasing filters into an equivalent temporal filter bank.
    The resulting antialiased driving functions ensure aliasing-free synthesis at a predefined listening position at the cost of temporally bandlimited sound field at other listening regions.
    The results of the proposed approach are compared with a recent LWFS approach employing direct spatial bandlimitation.
\end{abstract}

\begin{IEEEkeywords}
Wave Field Synthesis, LWFS, Spatial antialiasing
\end{IEEEkeywords}

\section{Introduction}

\section{Theoretical basics}
\subsection{The local propagation vector:}
Consider an arbitrary steady-state free space sound field at an angular frequency $\omega$.
As a standard ansatz in the field of geometrical acoustics the sound field can be written in the general polar from as 
\begin{equation}
P(\vx,\omega) = A^P(\vx) \te^{- \ti \omega \phi^P(\vx)},
\label{eq:Pxw}
\end{equation}
where $A^P(\vx)$ and $\phi^P(\vx)$ are real-valued functions. 
This formulation applies to both plane waves and (3D) point sources.
The propagation dynamics of the sound field are governed by its phase function $\phi^P(\vx)$, termed as the eikonal in the field of ray acoustics.
In the temporal domain, the sound field can be obtained by taking the inverse Fourier transform of \eqref{eq:Pxw}, yielding:
\begin{equation}
p(\vx,t) = A^P(\vx) \, \delta \! \left( t - \phi^P(\vx)\right).
\end{equation}
From the above formulation it is evident that the eikonal $\phi^P(\vx)$ describes the propagation delay the wavefront takes to arrive at $\vx$.
The eikonal equation is obtained by substituting the ansatz \eqref{eq:Pxw} into the Helmholtz equation, stating that in a source free volume 
\begin{equation}
    \left| \nabla \phi^P(\vx) \right| = \frac{1}{c}
\end{equation}
is fulfiled.
The gradient of the eikonal is termed as the local propagation vector 
\begin{equation}
    \hat{\vk}^P(\vx) = \posvec{3}{\hat{k}_x^P(\vx)}{\hat{k}_y^P(\vx)}{\hat{k}_z^P(\vx)} = c \nabla_{\! \vx} \phi^P(\vx,\omega).
\end{equation}
In steady-state, the local propagation vector is perpendicular to the wavefront (equiphase positions) at an arbitrary location with unit length pointing towards the local propagation direction \cite{Firtha2016}.
In the temporal domain it points into the local propagation direction at the time instant of the wavefront passby.

%For simplicity, in the followings we assume that all the involved fields propagate horizontally in the plane of investigation, i.e. $\hat{k}_z^P(x,y,0) = 0$.

\subsection{2.5D Wave Field Synthesis:}
Consider a smooth convex secondary source distribution located at $\vxo = \posvec{3}{x_0}{y_0}{0}$ consisting of a continuous distribution of 3D point sources, described by the 3D Green's function.
In this geometry the target field inside the area bounded by the SSD is described by the  Kirchhoff approximation of 2.5D Kirchhoff-Helmholtz integral, from which the 2.5D driving functions can be extracted.
For an arbitrary simple target virtual sound field $P(\vxo,\omega)$ the steady-state driving functions read as \cite{Firtha2016}
\begin{equation}
D(\vxo,\omega) = \underbrace{\sqrt{8\pi \frac{\ti \omega}{c}}}_{ H_{\text{pre}}(\omega) }
w(\vxo) \sqrt{d_{\mathrm{ref}}(\vxo)}
 P(\vxo,\omega)
\label{Eq:WFS25D}
\end{equation}
The driving function consists of 
\begin{itemize}
    \item a frequency dependent pre-equalization filter $H_{\text{pre}}(\omega)$ 
    \item a secondary source selection window 
    \begin{equation}
        w(\vxo) = \max{\left( \hat{k}_{\mathrm{n}}^P(\vxo),0\right)}, 
    \end{equation}
    where $\hat{k}_{\mathrm{n}}^P(\vxo)$ is the normal component of the local propagation vector 
    \item a gain factor $\sqrt{d_{\mathrm{ref}}(\vxo)}$ allowing amplitude correction along a reference curve, depending on the actual virtual field model (c.f. \cite{Firtha2016})
    \item the virtual field measured on the SSD.
\end{itemize}
Assuming a simple virtual sound field as given by \eqref{eq:Pxw} the driving functions can be written 
\begin{equation}
    D(\vxo,\omega) = H_{\text{pre}}(\omega)
    \underbrace{ w(\vxo)  \, \sqrt{d_{\mathrm{ref}}(\vxo)} \, A^P(\vxo) }_{A^D(\vxo)} \te^{- \ti \omega \phi^P(\vxo)}
\end{equation}    
and in the time domain as
\begin{equation}
d(\vxo,t) = h_{\text{pre}}(t) \ast_t  A^D(\vxo)\,  \delta\left( t - \phi^P(\vxo)\right),
\label{eq:d_wfs_td}
\end{equation}
with $A^D(\vxo)$ being the real valued overall gain factor of the driving function, $\ast_t$ denoting temporal convolution and $h_{\text{pre}}(t)$ is the temporal WFS prefilter impulse response.
For an analyitcal FIR pre-equalization filter implementation the reader is referred to \cite{Schultz2016}.
In the following due to the associativity of convolution this prefiltering is excluded from the discussion.

\subsection{Aliasing artifacts in WFS}

\section*{Acknowledgment}

This work was supported by the János Bolyai Research Scholarship of the Hungarian Academy of Sciences, the ÚNKP-22-5-BME-318 New National Excellence Program of the Ministry for Innovation and Technology from the source of the National Research, Development and Innovation Fund
and by the OTKA PD-143129 and OTKA K-143436 grants.

\bibliographystyle{unsrt}
\bibliography{dissertation}
\vspace{12pt}
\color{red}
IEEE conference templates contain guidance text for composing and formatting conference papers. Please ensure that all template text is removed from your conference paper prior to submission to the conference. Failure to remove the template text from your paper may result in your paper not being published.

\end{document}
