\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage[english]{babel}          % für deutsche Dokumente
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{overpic,subfigure, tikz}

\input{scidefs}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{Local Wave Field Synthesis by Temporal Bandlimitation*
    \thanks{This work was supported by the János Bolyai Research Scholarship of the Hungarian Academy of Sciences, the ÚNKP-22-5-BME-318 New National Excellence Program of the Ministry for Innovation and Technology from the source of the National Research, Development and Innovation Fund
        and by the OTKA PD-143129 and OTKA K-143436 grants.
    }
}

\author{\IEEEauthorblockN{Gergely Firtha}
    \IEEEauthorblockA{\textit{Dept. of Networked Systems and Services} \\
        \textit{Budapest University of Technologies and Economics}\\
        H-1111 Budapest, Hungary \\
        firtha@hit.bme.hu}
    \and
    \IEEEauthorblockN{Nara Hahn}
    \IEEEauthorblockA{\textit{Institute of Sound and Vibration Research} \\
        \textit{University of Southampton}\\
        Southampton, United Kingdom \\
        nara.hahn@soton.ac.uk}
    \and
    \IEEEauthorblockN{Frank Schultz}
    \IEEEauthorblockA{\textit{Institute of Communications Engineering} \\
        \textit{University of Rostock}\\
        18059 Rostock, Germany \\
        frank.schultz@uni-rostock.de}
    \and
    \IEEEauthorblockN{Péter Fiala}
    \IEEEauthorblockA{\textit{Dept. of Networked Systems and Services} \\
        \textit{Budapest University of Technologies and Economics}\\
        H-1111 Budapest, Hungary \\
        fiala@hit.bme.hu}
}

\maketitle

\begin{abstract}
    Wave Field Synthesis (WFS) aims at the reproduction of a desired target wavefront by driving an ideally continuous loudspeaker distribution with properly chosen secondary source driving signals.
    In practical applications, using a discrete set of loudspeakers degrades the accuracy of reproduction heavily due to the violation of the theoretical requirements.
    As a result, spatial aliasing wavefronts emerge from the individual loudspeaker elements in addition to the intended virtual wavefront, perceived as strong coloration above the so-called spatial aliasing frequency.
    Local Wave Field Synthesis (LWFS) approaches improve the reproduction accuracy over a limited listening area by allowing stronger artifacts outside the control region.
    The present contribution discusses a novel LWFS approach, relying on the transformation of spatially defined antialiasing filters into an equivalent temporal filter bank.
    The resulting antialiased driving functions ensure aliasing-free synthesis at a predefined listening position at the cost of temporally bandlimited sound field at other listening regions.
    The results of the proposed approach are compared with a recent LWFS approach employing direct spatial bandlimitation.
\end{abstract}

\begin{IEEEkeywords}
    Wave Field Synthesis, LWFS, Spatial antialiasing
\end{IEEEkeywords}

\section{Introduction}
\label{sec:introduction}
The aim of sound field synthesis is to reproduce a virtual target sound field over an extended listening area using a densely spaced loudspeaker arrangement, known as the secondary source distribution (SSD).
By feeding the loudspeakers with specific driving functions, the superposition of sound fields from each SSD element should ideally match the target sound field in the intended receiving area.
One prominent sound field synthesis method is Wave Field Synthesis (WFS) \cite{Berkhout1993:Acoustic_control_by_WFS, Start1997:phd}. 

As WFS obtains the necessary driving functions from a suitable boundary integral representation of the target sound field, perfect phase correct field-reconstruction could be only achieved by employing a theoretical, continuous secondary source distribution.
In practical applications the SSD consist of discrete loudspeaker elements, resulting in secondary wavefronts additionally to the intended virtual wavefront, emerging from the individual SSD elements, termed as aliasing waves.
This spatial aliasing phenomena is perceived as the coloration of the synthesized sound field above the spatial aliasing frequency, varying with the listening position and the virtual wavefront direction, degrading the quality of reproduction \cite{8371275, 8611109}.

The effect of aliasing can be mitigated by restricting the synthesis to a smaller control region inside the listening area at the cost of permitting stronger aliasing artifacts outside the region of interest.
These anti-aliased WFS approaches are commonly referred to as Local Wave Field Synthesis (LWFS).
Recently introduced LWFS approaches achieve increased local synthesis accuracy by the direct spatial bandlimitation of the WFS driving functions \cite{Winter2016-TASL, Hahn16:AES, Hahn17:EUSIPCO, hahn2022cylindrical}.
However, due to the high computational demand the real-time application of these LWFS approaches is not straightforward.

The present contribution introduces a novel LWFS approach, relying merely on the temporal bandlimitation of the SSD driving functions.
The temporal filters, defined uniquely for each SSD elements, are obtained from spatial antialiasing filters by means of an analytical spatial-to-temporal filter transformation, introduced by the current authors in a previous contribution \cite{firtha_daga2023}.
Similarly to other LWFS techniques, the presented approach ensures aliasing-free synthesis at a predefined listening position at the cost of temporally bandlimited sound field at other listening regions.
The results of the proposed approach are compared with a recent LWFS approach employing direct spatial bandlimitation.

The paper is organized as follows:
Section \ref{sec:theory} gives a brief theoretical introduction on basic WFS theory and spatial aliasing phenomena. 
Section \ref{sec:novel_approach} first discusses the spatial-to-temporal filter transform, then introduces the novel local WFS methodology.
Section \ref{sec:evaluation} gives a comparison of the presented technique with a recent LWFS approach based on direct modal bandlimitation, followed by a short summary and outlook in section \ref{sec:conclusion}. 

\section{Theoretical basics}
\label{sec:theory}

\subsection{The local propagation vector:}
Consider an arbitrary steady-state free space sound field at an angular frequency $\omega$.
As a standard ansatz in the field of geometrical acoustics the sound field is written in the general polar from as
%
\begin{equation}
    P(\vx,\omega) = A(\vx) \te^{- \ti \omega \tau(\vx)},
    \label{eq:Pxw}
\end{equation}
%
where $A(\vx)$ and $\tau(\vx)$ are real-valued functions.
This formulation applies to both plane waves and (3D) point sources.
The propagation dynamics of the sound field are governed by its phase function $\tau(\vx)$, termed as the eikonal in the field of ray acoustics \cite{Bleistein2000}.
In the temporal domain, the sound field can be obtained by taking the inverse Fourier transform of \eqref{eq:Pxw}, yielding:
\begin{equation}
    p(\vx,t) = A(\vx) \, \delta \! \left( t - \tau(\vx)\right).
\end{equation}
From the above formulation it is evident that the eikonal $\tau(\vx)$ describes the propagation delay the wavefront takes to arrive at $\vx$.
The eikonal equation is obtained by substituting the ansatz \eqref{eq:Pxw} into the Helmholtz equation, stating that in a source free volume
\begin{equation}
    \left| \nabla \tau(\vx) \right| = \frac{1}{c}
\end{equation}
is fulfilled.
The gradient of the eikonal is termed as the local propagation vector
\begin{equation}
    \hat{\vk}^P(\vx) = \posvec{3}{\hat{k}_x^P(\vx)}{\hat{k}_y^P(\vx)}{\hat{k}_z^P(\vx)} = c \nabla \tau(\vx,\omega).
\end{equation}
In steady-state, the local propagation vector is perpendicular to the wavefront (equiphase positions) at an arbitrary location of unit length pointing towards the local propagation direction \cite{Firtha2016}.
In the temporal domain it points into the local propagation direction at the time instant of the wavefront passby.

%For simplicity, in the followings we assume that all the involved fields propagate horizontally in the plane of investigation, i.e. $\hat{k}_z^P(x,y,0) = 0$.

\subsection{Conventional 2.5D Wave Field Synthesis}
Consider a smooth convex secondary source distribution located at $\vxo = \posvec{3}{x_0}{y_0}{0}$ consisting of a continuous distribution of 3D point sources, described by the 3D freefield Green's function, reading in the frequency domain as
\begin{equation}
    G_{3 \mathrm{D}}(\vx,\vxo,\omega) = \frac{1}{4\pi}\frac{\te^{-\frac{\omega}{c}\left| \vx-\vxo\right|}}{\left| \vx-\vxo\right|},
\end{equation}
where $\omega$ denotes the angular frequency.
In this geometry the target field inside the area bounded by the SSD is described by the  Kirchhoff approximation of 2.5D Kirchhoff-Helmholtz integral, from which the 2.5D driving functions can be extracted.
For an arbitrary simple target virtual sound field $P(\vxo,\omega)$ the steady-state driving functions read as \cite{Firtha2016}
\begin{equation}
    D(\vxo,\omega) = \underbrace{\sqrt{8\pi \frac{\ti \omega}{c}}}_{ H_{\text{pre}}(\omega) }
    w(\vxo) \sqrt{d_{\mathrm{ref}}(\vxo)}
    P(\vxo,\omega)
    .
    \label{Eq:WFS25D}
\end{equation}
The driving function consists of
\begin{itemize}
    \item a frequency dependent pre-equalization filter $H_{\text{pre}}(\omega)$ \cite{Start1997:phd, doi:10.1121/1.404755, Bleistein1986},
    \item a secondary source selection window \cite{Nicol1999, Spors2007}
          \begin{equation}
              w(\vxo) = \max{\left( \hat{k}_{\mathrm{n}}^P(\vxo),0\right)},
          \end{equation}
          where $\hat{k}_{\mathrm{n}}^P(\vxo)$ is the normal component of the local propagation vector,
    \item a gain factor $\sqrt{d_{\mathrm{ref}}(\vxo)}$ allowing amplitude correction along a reference curve, depending on the actual virtual field model (c.f. \cite{Start1997:phd} and for a more complete treatise \cite{Firtha2016}),
    \item and the virtual field measured on the SSD.
\end{itemize}
Assuming a simple virtual sound field as given by \eqref{eq:Pxw} the driving functions can be written as
\begin{equation}
    D(\vxo,\omega) = H_{\text{pre}}(\omega)
    \underbrace{ w(\vxo)  \, \sqrt{d_{\mathrm{ref}}(\vxo)} \, A(\vxo) }_{A^D(\vxo)} \te^{- \ti \omega \tau(\vxo)}
    ,
\end{equation}
and in the time domain as
\begin{equation}
    d(\vxo,t) = h_{\text{pre}}(t) \ast_t  A^D(\vxo)\,  \delta\left( t - \tau(\vxo)\right),
    \label{eq:d_wfs_td}
\end{equation}
with $A^D(\vxo)$ being the real valued overall gain factor of the driving function, $\ast_t$ denoting temporal convolution and $h_{\text{pre}}(t)$ is the temporal WFS prefilter impulse response.
The analytical, continuous pre-equalization filter impulse response is given in \cite{Deregowski1983, Firtha2019phd}, while for an ideal, non-casual FIR filter implementation the reader is referred to \cite{Schultz2016}.
In the following due to the associativity of convolution this prefiltering is excluded from the discussion.

\subsection{Aliasing artifacts in WFS}

\begin{figure*}[h!]
    \begin{center}
        \begin{overpic}[width = 0.75\columnwidth]{figs/ideal_synthesis.png}
            \footnotesize \put(0,2){(a)}
        \end{overpic} \hspace{2cm}
        \begin{overpic}[width = 0.75\columnwidth]{figs/aliased_synthesis.png}
            \footnotesize \put(0,2){(b)}
        \end{overpic}
        \\
        \begin{overpic}[width = 0.75\columnwidth]{figs/ideal_synthesis_spectrum.png}
            \footnotesize \put(0,0){(c)}
        \end{overpic} \hspace{2cm}
        \begin{overpic}[width = 0.75\columnwidth]{figs/aliased_synthesis_spectrum.png}
            \footnotesize \put(0,0){(d)}
        \end{overpic}
    \end{center}
    \caption{The synthesized field (top) and the spatial spectrum (bottom) of the driving function in case of ideal, quasi-continuous SSD (a) and (c), and in case of a discretized SSD (b) and (d).
    It is important to note that the spatial spectrum depicts only the non-zero Fourier components (i.e. the Fourier series coefficients) normalized to the sampling wavenumber.}
    \label{Fig:aliasing}
\end{figure*}
The backbone of WFS theory assumes a continuous secondary source distribution.
In practical applications the SSD is composed of evenly spaced discrete source elements.
As a result, \emph{aliasing wavefronts} emerge from the individual secondary sources, following the intended virtual wavefront, leading to a \emph{spatial aliasing phenomena}.
Although localization does not degrade due to the precedence effect, aliasing is perceived as strong coloration predominantly in the high-frequency region varying with the receiver position and the virtual source position/direction, occurring predominantly above the \emph{aliasing frequency}.

Figure \ref{Fig:aliasing} illustrates spatial aliasing in the temporal domain through the example of the synthesis of an impulsive plane wave, arriving from $\phi_{\mathrm{PW}} = 0^{\circ}$, applying a discrete secondary source distribution in comparison with a quasi-continuous synthesis scenario.
In the current example the SSD is a circular one with the radius of $R_0 = 2~\mathrm{m}$, consisting of $N_0 = 90$ 3D point sources.
The aliased synthesis in the temporal domain is depicted in Figure \ref{Fig:aliasing} (b).

Mathematically, aliasing can be modeled as the discretization of the theoretically continuous driving functions:
Assume that a suitable parametrization $d(s,t)$ of the secondary source is given, e.g. the arc length $s = R_0\, \cos \phi$ in case of a circular SSD (where $\phi$ is the polar angle), or the linear position on an infinite long linear SSD.
The discretization process is modeled by sampling the driving function by a sampling function, consisting of a series of Dirac-deltas, where the impulse occurences match the actual SSD positions:
\begin{equation}
    d_s(s,t) = \sum_{\nu = 0}^{N_0-1} d(s,t) \, \delta(s - \nu \Delta s) \, \Delta s,
    \label{eq:sampling_td}
\end{equation}
where $\Delta s$ is the sampling arc length.

By investigating the sampling process in the frequency-wavenumber domain, the spectrum of the sampled driving function is given by
\begin{equation}
    \tilde{D}_s(k_s,\omega) = \sum_{\nu = -\infty}^{\infty} \tilde{D}\left(k_s- \nu \frac{2\pi}{\Delta s},\omega\right) \Delta s,
    \label{eq:sampling_fd}
\end{equation}
where $t \rightarrow \omega$ and $s \rightarrow k_s$ are variables pairs for the Fourier-transform.
Obviously, for a closed SSD contour (most notably for a circular SSD) the continuous spatial Fourier-transform yields a discrete spectrum, consisting of non-zero components only on the multiples of the spatial wavenumber, i.e. at
\begin{equation}
    k_s = \frac{m}{R_0},
\end{equation}
constituting a Fourier series.

In the followings the spatial spectrum refers to the distribution of the non-zero wavenumber values, and the corresponding wavenumber refers to the spatial frequency (multipled by $2\pi$) of the harmonic basis functions, measured along the closed curve.
Figure \ref{Fig:aliasing} (c) and (d) illustrate the quasi-continuous and the sampled driving function's spectra.

From \eqref{eq:sampling_fd} it can be concluded that due to spatial sampling, the wavenumber content of the driving function is repeated on the multiples of the sampling wavenumber
\begin{equation}
k_{s, \mathrm{s}} = \frac{2\pi}{\Delta s}.
\end{equation}
Since the conventional driving functions are not-bandlimited, therefore, the repeating spectra will overlap above the Nyquist wavenumber $k_{s, \mathrm{Nyq}} = \frac{\pi}{\Delta s}$, for which the corresponding angular frequency is the aliasing frequency of the discretization scheme, as depicted in Figure \ref{Fig:aliasing} (d).

According to the sampling theorem, spatial aliasing can be avoided by analytically spatial-bandlimiting the driving functions to the Nyquist wavenumber.
This can be performed by either spatially filtering the driving functions with an appropriate spatial low-pass filter prior to numerical evaluation, or performing bandlimitation directly in the wavenumber (modal) domain analytically.
The latter approach is implemented by \cite{hahn2022cylindrical}, and will serve as a reference solution in the following investigation.
However, the modal bandlimitation solution is available only for plane wave and point source virtual source models synthesized by a circular SSD, at the cost of increased computational complexity.

In the following an alternative, approximate solution is presented, allowing spatial antialiasing filtering for an arbitrary virtual source model and arbitrary SSD contour, performed by FIR filtering in the temporal domain.
The technique relies on an analytic transform of spatially defined antialiasing filters to an equivalent temporal domain filter bank.

\section{Time domain antialiasing LWFS}
\label{sec:novel_approach}

\subsection{Spatial to temporal filter transform}
First, a general analytical approach is introduced allowing the transform of an arbitrary spatial filter to an equivalent temporal filter set.
From herein, subscript $x$ and $t$ distinguishes wether a filter is defined as a spatial or a temporal filter, respectively.

Assume an arbitrary filter impulse response defined in the spatial domain, denoted by $h_x(s)$.
Again, $s$ is a suitable parametrization of the SSD contour.
The spatially filtered driving function is obtained from the convolution of the conventional driving functions and the filter impulse response along the SSD contour
\begin{equation}
    d'_x(s,t) = h_x(s) \ast_s d(s,t) = \int h_x(s-s_0) \, d(s_0,t) \, \td s_0,
    \label{eq:spatial_conv}
\end{equation}
where $\ast_x$ denotes a circular convolution for a convex SSD contour or a linear convolution in case of an infinite long linear SSD.

Let's assume a temporal filter impulse response, defined for each SSD element $h_t(s,t)$.
The temporally filtered driving functions are obtained from the temporal convolution of each SSD elements' driving function by the corresponding temporal impulse response
\begin{equation}
    d'_t(s,t) = h_t(s,t) \ast_t d(s,t) = \int_{-\infty}^{\infty} h_t(s,t-t_0) \, d(s,t_0) \, \td t_0.
    \label{eq:temp_conv}
\end{equation}
Our aim is to express the temporal filter bank $h_t(s,t)$ in terms of the spatial filter, so that the result of the temporal convolution \eqref{eq:temp_conv} coincides with the spatial filtering result \eqref{eq:spatial_conv}, i.e.
\begin{equation}
    d'_x(s,t) = d'_t(s,t)
\end{equation}
holds.

\subsubsection{The exact transformation}
The following transformation is allowed by the spatio-temporal structures of the conventional driving functions \eqref{eq:d_wfs_td}, in which the spatial and temporal dimensions are interconnected in the argument of a Dirac-delta, due to the wave propagation characteristics.
The main idea of the derivation is that by exploiting the sifting property of the Dirac-delta in the driving functions, both spatial and temporal convolutions \eqref{eq:spatial_conv} and \eqref{eq:temp_conv} can be evaluated, from which the temporal filter impulse responses can be expressed as the function of the spatial ones.
Again, in the following the pre-equalization filter is omitted from discussion, since equalization filtering can be performed following the antialiasing process.

The temporal convolution in \eqref{eq:temp_conv} can be evaluated by substituting the general WFS driving function \eqref{eq:d_wfs_td} and exploiting the sifting property of the Dirac-delta, yielding
\begin{align}
    d'_t(s,t) = A^D(s) \, h_t \!\left(s,t- \tau(s) \right) \\
    d'_t(s,t + \tau(s) ) = A^D(s) \, h_t \!\left(s,t\right).
    \label{eq:temp_conv_eval}
\end{align}
In the second equation the time shift of $\tau(s)$ was applied for the sake of simplicity.

The shifted spatially filtered driving function reads as
\begin{multline}
    d'_x(s,t+ \tau(s) ) = \int h_x(s-s_0) \, d(s_0,t+ \tau(s) ) \, \td s_0 = \\
    \int h_x(s-s_0) \, A^D(s_0)\, \delta(s_0,t+ \left(\tau(s)-\tau(s_0)\right)  ) \, \td s_0.
    \label{eq:spat_conv2}
\end{multline}
In order to evaluate the spatial convolution the generalized sifting property of the Dirac-delta may be applied \cite{Firtha2019phd, Jackson1999}, which states that
\begin{equation}
    \int f(s_0) \delta(g(s_0)) \td s_0 = \sum_i \frac{f(s_i)}{| \frac{\partial}{\partial s_0} g(s_0) |_{s = s_i}}, \hspace{3mm} g(s_i) = 0.
\end{equation}
In the present problem the zeros of the Dirac's argument are found where
\begin{equation}
    \tau(s_i) = t + \tau(s)
    \label{eq:zero}
\end{equation}
is satisfied.
In the following it is assumed that a single zero $s_i$ exists, satisfying \eqref{eq:zero}.
This assumption means that the wavefront arrives at each SSD element at a unique time instant, being strictly true for a virtual plane wave and a linear SSD.
The derivative of the phase function is given by
\begin{equation}
    \frac{\partial}{\partial s_0} g(s_0) = - \frac{\partial}{\partial s_0} \tau(s_0) = -\frac{\hat{k}_t^P(s_0)}{c},
\end{equation}
i.e. it is the tangential component of the local propagation vector.
With the above assumptions the integral \eqref{eq:spat_conv2} can be evaluated, yielding
\begin{equation}
    d'_x(s,t+ \tau(s) ) =  \frac{ c }{|\hat{k}_t^P(s_i)|} \, h_x(s-s_i) \, A^D(s_i)
    .
    \label{eq:spat_conv_eval}
\end{equation}

Finally, by combining \eqref{eq:spat_conv_eval} and \eqref{eq:temp_conv_eval} the resulting general transformation relation between the spatial and temporal filters is given as
\begin{equation}
    h_t\left(s,t\right) = \frac{A^D(s_i)}{A^D(s)} \, \frac{ c }{|\hat{k}_t^P(s_i)|} h_x(s-s_i),
\end{equation}
where $s_i$ satisfies \eqref{eq:zero}.

\subsubsection{Local plane wave approximation}
The above formulation already allows one to transform an arbitrary spatial impulse response into an equivalent temporal filter for each SSD element, as long as the virtual field model is known and \eqref{eq:zero} can be solved.
In order to give a more general solution it is assumed that the virtual field is locally plane, being a usual high frequency assumption in WFS theory.
As a further general WFS assumption it is supposed that the SSD is locally plane.
These requirements inherently ensure that a single solution exists for \eqref{eq:zero}\footnote{Except for a plane wave arriving normally to the SSD, at which case the temporal filter is transformed into a Dirac-delta.}.
With these assumptions the phase function is given as
\begin{equation}
   \tau(\vx) = \frac{\hat{k}^P_x(\vx) \, x +  \hat{k}^P_y(\vx) \, y}{c}
\end{equation}
and \eqref{eq:zero} is satisfied where
\begin{equation}
    s_i = s + \frac{c \cdot t}{\hat{k}_t^P(s)}
    .
\end{equation}
Finally, as a crucial approximation it is assumed that both the amplitude of the driving function and the propagation vector varies slowly along the SSD, i.e $A^D(s_i) \approx A^D(s)$ and $\hat{k}_t^P(s_i) \approx \hat{k}_t^P(s)$ holds.
With these assumptions the corresponding filter transform reads as
\begin{equation}
    h_t\left(s,t\right) =\frac{ c }{|\hat{k}_t^P(s)|} h_x\left(-t \,\frac{c}{\hat{k}_t^P(s)}\right).
    \label{eq:temporal_transform}
\end{equation}

Equation \eqref{eq:temporal_transform} can be directly expressed in the spectral domain by taking the Fourier transform of both sides, relating the frequency response of the spatial and the temporal filters.
By denoting $\mathcal{F}\left( h_x(s)\right) = H_x(k_s)$ the corresponding transform is given by
\begin{equation}
    H_t\left(s,\omega\right) = H_x\left(-\frac{\omega}{c}\hat{k}_t^P(s)\right) = H_x\left(-k_t^P(s)\right),
    \label{eq:frequency_transform}
\end{equation}
where $k_t^P(s)$ is the tangential component of the local wavenumber vector, being a vector in a steady state sound field, pointing in the local propagation direction with the length being $\omega/c$ \cite{Firtha2019phd}.
Hence, as the main result of the present discussion, the temporal filter transfer can be obtained from the wavenumber (modal) content of the spatial filter by simple rescaling in terms of the local wavenumber vector.

The validity and the error analysis of the above filter transform was investigated in details in \cite{Firtha DAGA2023}.
In the following the direct application for local WFS is discussed.

\subsection{Application for antialiasing filtering}

Figure \ref{Fig:aliasing} (d) reflects that the overlapping of the sampled driving function spectra, and, therefore, the presence of aliasing waves can be avoided by spatially bandlimiting the driving functions to the Nyquist wavenumber prior to sampling.
Spatial bandlimitation can be straightforwardly performed by designing a suitable spatial antialiasing filter and transforming it into an equivalent temporal filter bank, based on the results of the previous section.
An important advantage of the above temporal filtering is that the driving functions may be evaluated in the discrete SSD positions, and a subsequent temporal antialiasing inherently ensures analytical spatial bandlimitation\footnote{
    The above statement holds as long as temporally continuous driving functions are assumed. Once the driving functions are sampled with a sampling frequency $f_s = 1 /\Delta t$, this corresponds to a spatial sampling prior to the filtering process with $\Delta s = c/f_s$.}.

Spectral overlapping can be avoided by bandlimiting the driving function to the sampling wavenumber $k_{s,\mathrm{s}} = \frac{2\pi}{\Delta s}$, with either symmetrically to $k_s = 0$ or by choosing an arbitrary central wavenumber $k_{s,0}$.
First the former case is investigated in details.

\subsubsection{Symmetrical antialiasing}
As the most straightforward antialiasing strategy, the spectral overlapping is avoided by the spatial lowpass filtering of the driving functions to the Nyquist wavenumber, $k_{s,\mathrm{Nyq}} = \frac{\pi}{\Delta s}$.

The effect of symmetrical bandlimitation is demonstrated via the exemplary low pass filter chosen to be an $N$-th order Butterworth design, defined in the wavenumber domain as
\begin{equation}
    H_x(k_s) = \frac{ 1 }{ \sqrt{ 1 + \left( k_s / k_{s,\mathrm{Nyq}} \right)^{2N} } }.
\end{equation}

From the transform given by \eqref{eq:frequency_transform} the angular frequency response of the equivalent temporal filter bank is given by
\begin{equation}
    H_t(s,\omega) = \frac{ 1 }{ \sqrt{ 1 + \left( \frac{\omega}{c}\frac{\hat{k}_t^P(s)}{k_{s,\mathrm{Nyq}}}  \right)^{2N} } } =  \frac{ 1 }{ \sqrt{ 1 + \left( \frac{\omega}{\omega_c(s)}  \right)^{2N} } } .
\end{equation}
with
\begin{equation}
    \omega_c(s) = c \frac{k_{s,\mathrm{Nyq}}}{\hat{k}_t^P(s)} = c\frac{ \pi}{\Delta s} \frac{1}{\hat{k}_t^P(s)}.
    \label{eq:cutoff_fr}
\end{equation}
Therefore, the cut-off frequency of the equivalent low-pass filter on a given SSD element is inversely proportional to the tangential component of the local propagation vector.

The result of antialiasing filtering is depicted in Figure \ref{Fig:symm_antialiasing} for the synthesis scenario discussed in the foregoing.
In the present case the sampling arc length is given by $\Delta s = \frac{2 \pi R_0}{N}$, i.e. the space-dependent cut-off frequency reads as 
\begin{equation}
    \omega_c(s) = \frac{ N}{ 2 R_0 } \frac{c}{\hat{k}_t^P(s)}.
\end{equation}
The antialiasing filters were a 4-th order Butterworth deisgn.

Figure (a) shows the result of the synthesis, while Figure (b) illustrates the spectrum of the bandlimited, sampled driving functions.
\begin{figure}[h!]
    \begin{center}
        \begin{overpic}[width = 0.75\columnwidth]{figs/firtha_center.png}
            \footnotesize \put(0,2){(a)}
        \end{overpic}
        \\
        \begin{overpic}[width = 0.75\columnwidth]{figs/antialiased_synthesis_spectrum.png}
            \footnotesize \put(0,0){(b)}
        \end{overpic}
    \end{center}
    \caption{Symmetric antialiasing filtering. Figure (a) depicts the synthesized wave front, and (b) illustrates the spatial spectrum of the driving functions.}
    \label{Fig:symm_antialiasing}
\end{figure}
It is highlighted that the presented antialiasing strategy ensures suppressed aliasing waves in the center of the circular source array.
In other positions of the listening area lateral aliasing wavefronts remain in the reproduced wave field, while the target, virtual wave front is bandlimited.
This phenomena can be easily understood by investigating the synthesis scenario in a geometrical manner:

Since the cutoff frequency of the antialiasing filter (Eq. \eqref{eq:cutoff_fr} ) is inversely proportional to the tangential component of the virtual field on the SSD, therefore, in a circular array a single SSD element will have nearly fullband driving signal: that SSD element at which the wavefront arrives perpendicularly.
This fullband SSD element is marked with white dot in Figure \ref{Fig:symm_antialiasing} (a).
From general WFS theory it is known that the fullband SSD element will dominate the synthesized wavefront (i.e. will serve as a stationary SSD position) for spatial positions along a straight line crossing the actual SSD element into the direction of the local propagation vector.
Therefore, the present antialiasing strategy ensures aliasing-free synthesis along a straight line for which the fullband SSD element is the stationary secondary source.
The direction of the line of aliasing-free synthesis is marked with a dashed arrow in the figure.
This is in contrast with previous local WFS approaches, in which the synthesis is optimized in the proximity of a pre-defined reference position over a circular area.

It should be noted that in the angular frequency domain the filtered driving function is written as
\begin{equation}
    D'_t(s,\omega) = D(s,\omega) H_t(s,\omega) =  H_x\left(-k_t^P(s)\right) \, D(s,\omega),
\end{equation}
from which formulation it is apparent that in the frequency domain the presented spatial-to-temporal filter transform strategy can be also interpreted as a frequency dependent spatial windowing approach, and the frequency dependent spatial window is given by $H_x\left(-k_t^P(s)\right)$:
in the aspect of antialiasing filtering SSD positions where the local wavenumber vector is higher than the Nyquist wavenumber are highly attenuated, with the window width decreasing with increasing angular frequency.
\begin{figure}[]
    \begin{overpic}[width = 1\columnwidth]{figs/equivalent_windows.png}
    \end{overpic}
    \caption{Illustration of equivalent frequency dependent window functions}
    \label{Fig:equivalent_windows}
\end{figure}
The actual shape of the spatial windows are given by the wavenumber spectrum of the spatial lowpass filter $H_x(k_s)$, rescaled in terms of the local wavenumber vector.
The set of window functions applied in the present simulation scenario are illustrated in Figure \ref{Fig:equivalent_windows}.

\subsubsection{Non-symmetrical antialiasing}
As an alternative antialiasing strategy, the overlapping of the spectra can be avoided by bandlimiting the driving function spectra with a spatial band-pass filter with an arbitrary center wavenumber $k_{s,0}$ and the bandwidth of the sampling wavenumber $k_{s,\mathrm{s}} = 2 k_{s,\mathrm{Nyq}}$.

Again, the concept is illustrated via a simple synthesis scenario as discussed in the foregoing.
In the present case the spatial bandpass filter is derived by shifting the $N$-th order low-pass Butterworth design to the a frequency dependent center wavenumber $k_{s,0}(\omega) = \frac{\omega}{c} \hat{k}_{s,0}$ (where $\hat{k}_{s,0}$ is a constant normalized wavenumber value)
\begin{equation}
    H_x(k_s, \omega) = \frac{ 1 }{ \sqrt{ 1 + \left( \frac{k_s-k_{s,0}(\omega)}{k_{s,\mathrm{Nyq}} }\right)^{2N} } }.
\end{equation}
Note, that in this case even the spatial filters are frequency dependent, in order to ensure that the transformed temporal filters remain time-invariant, as explained in the followings.

Again, an equivalent filter bank is derived by using the transform \eqref{eq:frequency_transform}, resulting in the frequency response of
\begin{equation}
    H_t(s,\omega) = \frac{ 1 }{ \sqrt{ 1 + \left( \frac{\omega}{c}\frac{\hat{k}_t^P(s) - \hat{k}_{s,0}}{k_{s,\mathrm{Nyq}}}  \right)^{2N} } } =  \frac{ 1 }{ \sqrt{ 1 + \left( \frac{\omega}{\omega_c(s)}  \right)^{2N} } }
    ,
\end{equation}
where $\hat{k}_{s,0}$ is the normalized center wavenumber and with
\begin{equation}
    \omega_c(s) = c \frac{k_{s,\mathrm{Nyq}}}{\hat{k}_t^P(s) - \hat{k}_{s,0}} = c\frac{ \pi}{\Delta s} \frac{1}{\hat{k}_t^P(s) - \hat{k}_{s,0}}.
    \label{eq:cutoff_asymm}
\end{equation}

\begin{figure}[h!]
    \begin{center}
        \begin{overpic}[width = 0.75\columnwidth]{figs/firtha_left.png}
            \footnotesize \put(0,2){(a)}
        \end{overpic}
        \\
        \begin{overpic}[width = 0.75\columnwidth]{figs/antialiased_synthesis_spectrum_steered.png}
            \footnotesize \put(0,0){(b)}
        \end{overpic}
    \end{center}
    \caption{Non-symmetric antialiasing filtering. Figure (a) depicts the synthesized wave front, and (b) illustrates the spatial spectrum of the driving functions.}
    \label{Fig:assymm_antialiasing}
\end{figure}
The application of the above formulation with an arbitrarily chosen center wavenumber $\hat{k}_{s,0} = 0.5$ is depicted in Figure \ref{Fig:assymm_antialiasing}.
Note that the wavenumber content of the original spatial lowpass filter is ,,steered'', so that the center frequency varies linearly with the angular frequency and the slope of the variation is given by the normalized center wavenumber.
Obviously, this ,,steered'', frequency dependent band-pass filter theoretically also ensures non-overlapping spectra after the discretization process.

From \eqref{eq:cutoff_asymm} it is apparent that in the present case the nearly fullband SSD element will be that, where the tangential local propagation vector coincides with the normalized center wavenumber, i.e. where $\hat{k}_t^P(s) = \hat{k}_{s,0} = 0.5$.
Again, the fullband SSD element is denoted by white dot in Figure \ref{Fig:assymm_antialiasing} (a).
Similarly to the previous case, this fullband SSD element serves as the stationary SSD position for a set of positions located along a straight line passing through the SSD element with the direction given by this element's local propagation vector.
The direction along which fullband synthesis is ensured is denoted by a dashed arrow in Figure \ref{Fig:assymm_antialiasing} (a).


It is important to emphasize that if no actual SSD element exists for a given plane wave direction (for which the wave arrives perpendicularly) then all the SSD elements are bandlimited, i.e. in the synthesized field no fullband synthesis positions will be present.
Therefore, for a given receiver position the bandwidth of the reproduced field will depend on the virtual source position/virtual plane wave direction and the loudspeaker spacing.
This phenomena will have a clearly audible effect in case of dynamic WFS scenarios (e.g. moving virtual sources) and the possibilities to overcome this limitation is the topic of future research.

\subsubsection{Application for Local Wave Field Synthesis}
The findings of the previous subsections can be straightforwardly used in order to apply the above theory directly for Local Wave Field Synthesis.
In this case a reference position $\vxref$ is prescribed inside the SSD, at which aliasing-free, amplitude and phase correct synthesis has to be ensured.

Amplitude correct synthesis may be achieved by a suitably chosen reference function in \eqref{Eq:WFS25D}, based on the virtual field model.
For a detailed treatise on the definition of the reference function the reader is referred to \cite{Firtha2019phd}.

On the other hand, aliasing components can be suppressed by ,,steering'' the direction of antialiased synthesis to cross the prescribed reference point.
This can be performed by finding the stationary position on the SSD for the reference position and choosing the normalized center wavenumber in \eqref{eq:cutoff_asymm} to coincide with the local propagation vector of the stationary position.
Mathematically, this can be formulated as follows.
Given a reference position $\vxref$ and an SSD located along $\vxo$, the stationary SSD element $\vxo^*$ satisfies
\begin{equation}
    \frac{\vxref - \vxo^*}{\left| \vxref - \vxo^* \right|} = \hat{\vk}^P(\vxo^*).
\end{equation}
Once $\vxo^*$ is found, the center wavenumber in \eqref{eq:cutoff_asymm} is found by
\begin{equation}
    \hat{k}_{s,0} = \hat{k}_t^P(\vxo^*).
\end{equation}

Obviously, symmetrical antialiasing filtering, depicted in Figure \ref{Fig:symm_antialiasing} can be regarded as LWFS with choosing $\vxref = [0, \, 0]^{\mathrm{T}}$,
while Figure \ref{Fig:assymm_antialiasing}, illustrating asymmetrical filtering was generated by choosing $\vxref = [0, \, 1]^{\mathrm{T}}$.
In both cases in Figure \ref{Fig:symm_antialiasing} and \ref{Fig:assymm_antialiasing} (a) the reference position is denoted by a black cross.

\section{Comparison with direct modal bandlimitation}
\label{sec:evaluation}

\begin{figure}[]
    \begin{center}
        \begin{overpic}[width = 0.75\columnwidth]{figs/nara_spectrum_center.png}
            \footnotesize \put(0,2){(a)}
        \end{overpic}
        \\
        \begin{overpic}[width = 0.75\columnwidth]{figs/nara_spectrum_left.png}
            \footnotesize \put(0,0){(b)}
        \end{overpic}
    \end{center}
    \caption{Spectrum of LWFS driving functions by direct modal bandlimitation with the reference position choosen at the center, $\vxref = \left[0,0,0\right]^{\mathrm{T}}$ (a) and on the left side, $\vxref = \left[0,1,0\right]^{\mathrm{T}}$ (b).
    }
    \label{Fig:nara_spectrum}
\end{figure}

\begin{figure*}[]
    \begin{center}
        \begin{overpic}[width = 0.45\columnwidth]{figs/firtha_center2.png}
            \footnotesize \put(0,2){(a)}
            \footnotesize \put(45,102){Center}
        \end{overpic} \hspace{3mm}
        \begin{overpic}[width = 0.45\columnwidth]{figs/firtha_left2.png}
            \footnotesize \put(0,2){(b)}
            \footnotesize \put(45,102){Left}
        \end{overpic}\hspace{3mm}
        \begin{overpic}[width = 0.45\columnwidth]{figs/firtha_front.png}
            \footnotesize \put(0,2){(c)}
            \footnotesize \put(45,102){Front}
        \end{overpic} \hspace{3mm}
        \begin{overpic}[width = 0.45\columnwidth]{figs/firtha_back.png}
            \footnotesize \put(0,2){(d)}
            \footnotesize \put(45,102){Back}
        \end{overpic}\\  \vspace{5mm}
        \begin{overpic}[width = 0.45\columnwidth]{figs/nara_center.png}
            \footnotesize \put(0,2){(e)}
        \end{overpic} \hspace{3mm}
        \begin{overpic}[width = 0.45\columnwidth]{figs/nara_left.png}
            \footnotesize \put(0,2){(f)}
        \end{overpic}\hspace{3mm}
        \begin{overpic}[width = 0.45\columnwidth]{figs/nara_front.png}
            \footnotesize \put(0,2){(g)}
        \end{overpic} \hspace{3mm}
        \begin{overpic}[width = 0.45\columnwidth]{figs/nara_back.png}
            \footnotesize \put(0,2){(h)}
        \end{overpic}\\ \vspace{5mm}
        \begin{overpic}[width = 0.45\columnwidth]{figs/transfer_center.png}
            \footnotesize \put(0,2){(i)}
        \end{overpic} \hspace{3mm}
        \begin{overpic}[width = 0.45\columnwidth]{figs/transfer_left.png}
            \footnotesize \put(0,2){(j)}
        \end{overpic}\hspace{3mm}
        \begin{overpic}[width = 0.45\columnwidth]{figs/transfer_front.png}
            \footnotesize \put(0,2){(k)}
        \end{overpic} \hspace{3mm}
        \begin{overpic}[width = 0.45\columnwidth]{figs/transfer_back.png}
            \footnotesize \put(0,2){(l)}
        \end{overpic}\\
    \end{center}
    \caption{Comparison of the proposed, temporal filtering-based LWFS approach with direct modal bandlimitation.
    First row (a-d) depicts the synthesized field with temporal LWFS, Second row (e-h) depicts the synthesized field with modal bandlimitation and third row (i-l) compares the frequency response at the reference position.}
    \label{Fig:comparison}
\end{figure*}

Finally, the performance of the proposed Local Wave Field Synthesis approach is compared with conventional a LWFS implementation, based on direct modal bandlimitation.
\input{lwfs-spl.tex}

The two methods are compared via the exemplary synthesis scenario discussed in the foregoing, synthesizing an impulsive plane wave, by bandlimiting the driving functions to the Nyquist wavenumber.
The result of synthesis is investigated for four different reference positions:
\begin{itemize}
    \item Center: $\vxref = \left[0,0,0\right]^{\mathrm{T}}$
    \item Left: $\vxref = \left[0,1,0\right]^{\mathrm{T}}$
    \item Back: $\vxref = \left[-1,0,0\right]^{\mathrm{T}}$
    \item Front: $\vxref = \left[1,0,0\right]^{\mathrm{T}}$
\end{itemize}

For the central and the left reference positions first the spectra of the driving functions were investigated.
Figure \ref{Fig:nara_spectrum} already reflects the fact that the proposed temporal LWFS approach is an approximation of the reference solution, i.e. of the direct modal bandlimitation.
It is verified that modal bandlimitation LWFS performs the same "steering" of the modal spectrum into the direction of the central wavenumber, realizing a freuqency dependent spatial band-pass filter.

Figure \ref{Fig:comparison} presents the comparison of the result of the two approaches via the synthesized field and the frequency response, each column illustrating a different reference position.
The first row (a-d) shows the synthesized field at the time instant of the plane wave pass-by through the reference position by implementing the proposed LWFS approach, with the second row (e-h) depicting the same result with using modal bandlimitation. 
The third row illustrates the measured frequency response of the synthesized fields at the reference positions.

The figures reflects that both methods are capable of sufficient suppression of the aliasing wave fronts at the prescribed reference position in a qualitatively similar manner.
The measured frequency responses show that the presented approach slightly suffers from ripples above the spatial aliasing frequency.
This remaining aliasing artifact can be explained as the result of the approximations, introduced in the derivation of the temporal-to-spatial filter transform.

In the center position the modal bandlimitation approach serves as a reference solution, with nearly perfect aliasing suppression.
For off-center positions both methods suffers from remaining aliasing artifacts.
This effect is even enhanced in the case of the front position, in which case the receiver/reference position is closer to the stationary SSD position (white SSD element).
The phenomena is explained by the spatial variation of the spatial aliasing frequency and the aliasing intensity, which has been already investigated in details in \cite{8611109} in a geometrical manner.
The incorporation of this effect in the present antialiasing strategy is the subject of a further research. 
Yet, it has been already reported that choosing a non-critical modal bandwidth below the Nyquist wavenumber is an efficient strategy to avoid these remaining aliasing wavefront \cite{Hahn17:EUSIPCO}.

\section{Conclusion}
\label{sec:conclusion}

The present contribution discussed a novel local Wave Field Synthesis approach, allowing an increased synthesis accuracy in the proximity of a reference position when a sparse SSD is applied for sound field reproduction.
The approach relies on a filter transformation that allows derivation of a temporal filter bank from an arbitrary spatial filter.
Local WFS is achieved by spatial bandlimiting of the SSD driving function to the Nyquist wavenumber, achieved by suitable spatial filtering.
By transforming the spatial antialiasing filters to a temporal filter bank, LWFS can be performed by the simple temporal bandlimitation of the SSD driving signals.

It was demonstrated via numerical simulations that the approach is capable of the suppression of aliasing wavefronts along a straight line/ray, passing through a predefined the reference position.
The direction of antialiasing synthesis can be set by adjusting the center wavenumber of the antialiasing spatial band-pass filter.
The performance of the presetned approach was compared with LWFS by direct modal bandlimitation taken as a direct, reference solution.
It was shown that temporal LWFS gives a feasible approximation for the reference one, while being a more robust approach with less computational demand, allowing even real-time implementations. 
Furthermore, altough the proposed approach was validated via the example of a virtual plane wave, the technique is capable of the aliasing-free synthesis of an arbitrary simple virtual field model.

It was demonstrated that both approaches suffer for remaining aliasing artifacts in off-center reference positions that's suppression is the topic of further research.

Finally, as an important limitation of the proposed technique it has to be pointed out, that since the proposed approach bandlimits the driving signals as the function of the local propagation direction of the virtual field on the SSD, therefore, the overall synthesis bandlimit varies with the virtual source direction/position.
This can result in enhanced artifacts in case of a non-stationary virtual field, e.g. in case of the synthesis of a moving source.
The workaround for this phenomena is also the subject of future research.

\section*{Acknowledgment}

This work was supported by the János Bolyai Research Scholarship of the Hungarian Academy of Sciences, the ÚNKP-22-5-BME-318 New National Excellence Program of the Ministry for Innovation and Technology from the source of the National Research, Development and Innovation Fund
and by the OTKA PD-143129 and OTKA K-143436 grants.

\bibliographystyle{unsrt}
\bibliography{dissertation}
\vspace{12pt}

\end{document}
